extFilter
===========
Программа для блокирования сайтов из списка РКН с использованием DPDK и nDPI.

Функционал
----------
Программа осуществляет блокировку сайтов путем анализа зеркалированного трафика от пользователей.
В случае нахождения вызываемого абонентом HTTP ресурса в списке блокировки, пользователю отсылается редирект на специальную страницу или сбрасывается соединение.
Блокировка HTTPS ресурсов осуществляется на основе имени сервера в client hello запросе от пользователя или ip адреса сервера, если имени сервера нет в client hello запросе.
В случае нахождения вызываемого абонентом HTTPS ресурса в списке блокировки, соединение с данными ресурсом будет сброшено.

Требования
----------
Для сборки программы необходимы следующие библиотеки и программы:

- Poco >= 1.6
- nDPI = git dev (устанавливается автоматически)
- PcapPlusPlus = git master (устанавливается автоматически)
- DPDK = 16.07
- git

Сборка
------
- [Установить DPDK](http://dpdk.org/doc/quick-start)
- Сгенерировать configure
```bash
./autogen.sh
```
- Запустить configure
```bash
./configure --with-dpdk_target=<target> --with-dpdk_home=<path_to_compiled_dpdk>
```
- Скомпилировать программу
```bash
make
```

Настройка DPDK
--------------
Для работы DPDK необходимо настроить huge-pages и подключить необходимые сетевые адаптеры в DPDK.

Запуск
------
Параметры работы программы задаются в конфигурационном файле.
Для запуска программы необходимо указать путь к конфигурационному .ini файлу (--config-file в командой строке). Для запуска в режиме daemon необходимо указать ключи --daemon и --pidfile=/path/to/file.pid

Файлы списков блокировки
------------------------
Файлы с данными для блокировки (домены, url и т.д.) должны быть в формате [nfqfilter](https://github.com/max197616/nfqfilter).

